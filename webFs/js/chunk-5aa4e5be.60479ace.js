(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5aa4e5be"],{"04e6":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tree webFsScroll"},[a("el-tree",{ref:"tree",attrs:{data:e.treeData,"highlight-current":"","node-key":"id","default-expand-all":"",props:e.defaultProps,"filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,n=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",{class:{disabled:"offline"===n.onlineStatus&&!n.children},attrs:{title:isNaN(n.deviceCountTotal)?""+i.label:i.label+"["+n.deviceCountOnline+"/"+n.deviceCountTotal+"]"}},[n.class?a("span",{class:n.class}):e._e(),a("i",{class:{extra:!n.children},attrs:{id:"liveVideo"+n.id}},[e._v(" "+e._s(i.label)+" "),isNaN(n.deviceCountTotal)?e._e():a("a",[e._v("["+e._s(n.deviceCountOnline)+"/"+e._s(n.deviceCountTotal)+"]")])]),a("b",{attrs:{obj:JSON.stringify(Object.assign({},n,{deviceCode:i.parent.data.id,deviceAddress:i.parent.data.deviceAddress,deviceBrand:i.parent.data.deviceBrand,parentLabel:i.parent.data.label,labelTotal:i.parent.data.label+"-"+n.label}))}})])])}}])})],1)},n=[],r=(a("ecb4"),{props:{treeData:{type:Array,default:function(){return[]}},isLive:{type:Boolean,default:!0},isLiveTree:{type:Boolean,default:!0}},data:function(){return{defaultProps:{children:"children",label:"label"}}},methods:{filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},handleNodeClick:function(e,t){var a=t.parent.data;if(!0===e._bIsDevice?this.$emit("clickAnDeviceItem",e):!0===a._bIsDevice&&this.$emit("clickAnDeviceItem",a),!e.children){var i=document.getElementById("liveVideo"+e.id).parentElement;if("offline"===e.onlineStatus&&this.isLive)return void this.$nextTick((function(){i.parentElement.parentElement.parentElement.classList.remove("is-current")}));if(this.isLive){var n={isShowOperate:!1,deviceCode:t.parent.data.id,deviceAddress:t.parent.data.deviceAddress,deviceBrand:t.parent.data.deviceBrand,parentLabel:t.parent.data.label,labelTotal:t.parent.data.label+"-"+e.label,deviceLatitude:t.parent.data.deviceLatitude,deviceLongitude:t.parent.data.deviceLongitude},r=Object.assign({},e,n);this.isLiveTree?i.getAttribute("class")?(i.setAttribute("class",""),this.$nextTick((function(){i.parentElement.parentElement.parentElement.classList.remove("is-current")})),this.$emit("videoChange",2,r)):(i.setAttribute("class","liveIcon"),i.parentElement.parentElement.parentElement.classList.add("is-current"),console.log(r),this.$emit("videoChange",1,r)):this.$emit("selectedDevice",r)}else{for(var s=document.querySelectorAll(".el-tree-node"),o=0;o<s.length;o++)s[o].classList.remove("is-current");i.parentElement.parentElement.parentElement.classList.add("is-current"),this.$emit("selectedChange",e,t.parent.data)}}},addParentDisabled:function(){for(var e=document.querySelectorAll("span.disabled"),t=0;t<e.length;t++)this.isLive&&(e[t].parentElement.parentElement.style.pointerEvents="none",e[t].parentElement.parentElement.style.cursor="not-allowed"),e[t].parentElement.parentElement.style.opacity="0.5",e[t].parentElement.parentElement.style.color="#007291"}},created:function(){var e=this;this.$nextTick((function(){e.addParentDisabled()}))}}),s=r,o=(a("cce6"),a("9ca4")),l=Object(o["a"])(s,i,n,!1,null,"4e05cd31",null);t["a"]=l.exports},"1c2e":function(e,t,a){"use strict";var i=a("1944"),n=a("857c"),r=a("efe2"),s=a("99ad"),o="toString",l=RegExp.prototype,c=l[o],d=r((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),u=c.name!=o;(d||u)&&i(RegExp.prototype,o,(function(){var e=n(this),t=String(e.source),a=e.flags,i=String(void 0===a&&e instanceof RegExp&&!("flags"in l)?s.call(e):a);return"/"+t+"/"+i}),{unsafe:!0})},"3a1b":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var i={getTodayFireAlarmInfos:"/cloud-video/deviceAlarm",getDurationFireAlarmInfos:"/cloud-video/deviceAlarm/list",confirmFireAlarmInfo:"/cloud-video/deviceAlarm/status"}},"4e09":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box"},[a("div",{staticClass:"leftNav"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.showLeft,expression:"showLeft"}],staticClass:"left"},[e._t("left")],2),e.showLeft?a("span",{staticClass:"iconRight",on:{click:function(t){return t.stopPropagation(),e.operateNav(1)}}}):a("span",{staticClass:"iconLeft",on:{click:function(t){return t.stopPropagation(),e.operateNav(2)}}})]),a("div",{staticClass:"center"},[e._t("center")],2),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowRight,expression:"isShowRight"}],staticClass:"rightInfo"},[e.showRight?a("span",{staticClass:"iconLeft",on:{click:function(t){return t.stopPropagation(),e.operateInfo(1)}}}):a("span",{staticClass:"iconRight",on:{click:function(t){return t.stopPropagation(),e.operateInfo(2)}}}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showRight,expression:"showRight"}],staticClass:"right"},[e._t("right")],2)])])},n=[],r={name:"box",props:{showLeft:{type:Boolean,default:!0},showRight:{type:Boolean,default:!0},isShowRight:{type:Boolean,default:!0}},methods:{operateNav:function(e){this.$emit("hideLeftNav",e)},operateInfo:function(e){this.$emit("hideRightInfo",e)}},created:function(){}},s=r,o=(a("b9ea"),a("9ca4")),l=Object(o["a"])(s,i,n,!1,null,null,null);t["a"]=l.exports},"75d8":function(e,t,a){"use strict";var i=a("8488"),n=a.n(i);n.a},8488:function(e,t,a){},"864b":function(e,t,a){},"889e":function(e,t,a){},"95f9":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"fireAlarm"},[i("videoMain",{attrs:{showLeft:e.showLeft,isShowRight:e.isShowRight},on:{hideLeftNav:e.closeLeftNav}},[i("div",{attrs:{slot:"left"},slot:"left"},[i("div",{staticClass:"leftContainer"},[i("div",{staticClass:"tab"},[i("div",{class:{active:e.isOnline},on:{click:function(t){return t.stopPropagation(),e.changeOnlineOrAll(!0)}}},[e._v("在线")]),i("div",{class:{active:!e.isOnline},on:{click:function(t){return t.stopPropagation(),e.changeOnlineOrAll(!1)}}},[e._v("全部")])]),e.isOnline?[i("div",{staticClass:"onlineList webFsScroll"},e._l(e.onlineArray,(function(t,a){return i("div",{key:a,staticClass:"list",class:{selected:e.selectedIndex==a,unman:"WRJ"===t.deviceTypeCode},on:{click:function(i){return i.stopPropagation(),e.selectOnlineDeviceItem(t,a)}}},[i("p",[i("span",{staticClass:"area"},[e._v(e._s(t.label))])]),i("div",{staticClass:"btns"},e._l(t.children,(function(t,a){return i("el-button",{key:a,staticClass:"visible",attrs:{title:t.label}},[e._v(e._s(t.label&&t.label.length>3?t.label.slice(0,3)+"..":t.label?t.label:"-"))])})),1)])})),0)]:[i("div",{staticClass:"search"},[i("el-input",{attrs:{type:"text",placeholder:"请输入设备名称","suffix-icon":"el-icon-search"},model:{value:e.filterDevice,callback:function(t){e.filterDevice="string"===typeof t?t.trim():t},expression:"filterDevice"}})],1),i("tree-data",{ref:"tree",attrs:{treeData:e.treeData,isLiveTree:!1},on:{clickAnDeviceItem:e.clickAnDeviceItem}})],e.isOnline&&0===e.onlineArray.length||!e.isOnline&&0===e.treeData.length?i("div",{staticClass:"empty"},[e._v("暂无数据")]):e._e()],2)]),i("div",{attrs:{slot:"center"},slot:"center"},[i("div",{staticClass:"video"},[i("div",{staticClass:"fireAlarmBox"},[i("div",{staticClass:"title"},[i("img",{attrs:{src:a("ae5c")},on:{click:function(t){return t.stopPropagation(),e.$router.go(-1)}}}),e._v("火点火情 ")]),i("div",{staticClass:"container"},[i("gMap",{ref:"gduMap",attrs:{handleType:"devMap",bShowSimpleSearchTools:!0,bShowBasic:!0,bShowMeasure:!1,bAutoLocate:!1}}),i("div",{staticClass:"todayFire"},[i("div",{staticClass:"title"},[e._v("今日火情警报["+e._s(e.fireConfirmedNum+"/"+e.fireTotalNum)+"]")]),i("div",{staticClass:"info webFsScroll"},e._l(e.fireWarningArray,(function(t,n){return i("div",{key:n,staticClass:"list",class:{unConfirmedItem:!t.bConfirmed,confirmedItem:t.bConfirmed},on:{click:function(a){return a.stopPropagation(),e.selectFireWarningHandler(t,n)}}},[i("div",{staticClass:"address"},[i("div",[e._v(e._s(t.alarmTime))]),i("div",{staticClass:"devNameBox",on:{click:function(a){return a.stopPropagation(),e.gotoDeviceDetail(t)}}},[i("img",{staticClass:"devIcon",attrs:{src:a("9965")}}),i("div",{staticClass:"devName divEllipsis",attrs:{title:t.deviceName}},[e._v(e._s(t.deviceName))])]),i("div",{staticClass:"alarmAddr divEllipsis",attrs:{title:t.alarmAddress}},[e._v(e._s(t.alarmAddress))])])])})),0)])],1)])])])]),i("span",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.copyCoordinate,expression:"copyCoordinate",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopyOK,expression:"onCopyOK",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onCopyErr,expression:"onCopyErr",arg:"error"}],ref:"copyText",staticStyle:{display:"none"}}),i("el-dialog",{attrs:{"custom-class":"el-dialog-custom",visible:e.imgDialogVisible,"show-close":!1,type:"primary",center:""},on:{"update:visible":function(t){e.imgDialogVisible=t}},nativeOn:{click:function(t){return e.closeImgDialog(t)}}},[i("img",{staticClass:"dialogImg",attrs:{src:e.imgSrc}})])],1)},n=[],r=(a("fe59"),a("513c"),a("08ba"),a("4e09")),s=a("04e6"),o=a("e27c"),l=a("9a0d"),c={name:"fireAlarm",components:{VideoMain:r["a"],TreeData:s["a"]},data:function(){return{isShowRight:!1,bShowMarkersInMap:!0,bRealTimeFireWarning:!0}},mixins:[o["a"],l["a"]],methods:{changeOnlineOrAll:function(e){if(Number(this.isOnline)!==Number(e))if(this.isOnline=e,this.isOnline)for(var t=document.querySelectorAll(".el-tree-node"),a=0;a<t.length;a++)t[a].classList.remove("is-current");else this.selectedIndex=200,this.onlineArray.forEach((function(e){e.children.forEach((function(e){e.isSelected=!1}))}))},showDeviceDetailInfo:function(e){this.$refs.gduMap.map2D.devCameraLayerManager.resetSelectedFeature(),this.$refs.gduMap.map2D.devDroneLayerManager.resetSelectedFeature(),this.$refs.gduMap.map2D.devFireWarningLayerManager.resetSelectedFeature(),"GDJK"===e.deviceTypeCode?(this.$refs.gduMap.showLayer("high",!0),this.$refs.gduMap.map2D.devCameraLayerManager.selectFeatureByID(e)):"WRJ"===e.deviceTypeCode&&(this.$refs.gduMap.showLayer("drone",!0),this.$refs.gduMap.map2D.devDroneLayerManager.selectFeatureByID(e)),this.$refs.gduMap.map2D.setZoom(16),this.$refs.gduMap.map2D.zoomToCenter(e.deviceLongitude,e.deviceLatitude)},selectOnlineDeviceItem:function(e,t){this.showDeviceDetailInfo(e),this.selectedIndex=t},clickAnDeviceItem:function(e){this.showDeviceDetailInfo(e)}}},d=c,u=(a("75d8"),a("9ca4")),f=Object(u["a"])(d,i,n,!1,null,"3e84a7c4",null);t["default"]=f.exports},9965:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAALCAYAAAB24g05AAABFklEQVQoU43SsUvXYRDH8dcHsUlcBB0Mh9ybxNUlJ6fGpv6AHISgQXATwl2rIUhQxwbnBpG2NlHHIAhSJInQwUF65OT7A5HU38Ez3PPc8767z12gtTaEr1ivk+Rv3fdj6QAvu8/lnmMTa0kOHoL0AF/w7FZwwy5WsZ3k8n+wtNYe4wcG7sn2Ex/wMcnJzbgCvMHKQ6V27xeYSnLYiy/AW7zGYB+QLXzDRpI/Fd/TYAYFeoKxO0BHeI/FruI5/O4BnuMTTnGMR1XqLdACllGCT2McS9eAbpTvMIJRzOIpXuEFPmOvq7LEnMc/TJYG3zvGcLWQ5Oxm5tZaQS9rubqJlb+D/SQzBai+yy6S/OpDyNrc0mwiycYV8cBaVpqQangAAAAASUVORK5CYII="},"9a0d":function(e,t,a){"use strict";a("4194"),a("fe59"),a("ecb4"),a("ea69"),a("08ba");var i=a("3a1b"),n=a("986e"),r=a("b705"),s=a("c466"),o=a("0a1b"),l={data:function(){return{fireWarningArray:[],fireConfirmedNum:0,fireTotalNum:0,bAutoMove:!0,copyCoordinate:"",imgDialogVisible:!1,imgSrc:""}},created:function(){var e=this;this.bShowMarkersInMap&&n["a"].$on("getFireAlarmInfos_Done",(function(t){e.markFireWarnings()})),n["a"].$on("getFireAlarm",(function(t){"mistaken"!==t.alarmStatus&&(t.bConfirmed=!1,t.alarmTime=Object(s["c"])(t.alarmTime),e.handlingAlarmImgUrl(t),e.fireWarningArray.push(t),e.fireTotalNum=e.fireWarningArray.length,e.bShowMarkersInMap&&e.addNewFireWarning(t))})),this.getTodayFireAlarmInfos()},beforeDestroy:function(){this.bShowMarkersInMap&&n["a"].$off("getFireAlarmInfos_Done"),this.bRealTimeFireWarning&&n["a"].$off("getFireAlarm")},mounted:function(){this.bShowMarkersInMap&&(this.$refs.gduMap.map2D.devFireWarningLayerManager.popupCopyBtnClickEvent.addEventListener(this.copyCoordinateCB),this.$refs.gduMap.map2D.devFireWarningLayerManager.popupLeftImgClickEvent.addEventListener(this.callbackLeftImg),this.$refs.gduMap.map2D.devFireWarningLayerManager.popupOneImgClickEvent.addEventListener(this.callbackMidImg),this.$refs.gduMap.map2D.devFireWarningLayerManager.popupRightImgClickEvent.addEventListener(this.callbackRightImg),this.$refs.gduMap.map2D.devFireWarningLayerManager.popupMisreportBtnClickEvent.addEventListener(this.callbackMistaken),this.$refs.gduMap.map2D.devFireWarningLayerManager.popupConfirmBtnClickEvent.addEventListener(this.callbackConfirmed))},methods:{handlingAlarmImgUrl:function(e){e.alarmPicList&&e.alarmPicList.length>0&&e.alarmPicList.forEach((function(e){e.picPath=o["a"].baseUrl+"/video-service2"+e.picPath}))},handlingFireWarningData:function(e){var t=this;e.forEach((function(e){"mistaken"!==e.alarmStatus&&(e.bConfirmed=!1,"confirmed"===e.alarmStatus&&(e.bConfirmed=!0,t.fireConfirmedNum++),e.alarmTime=Object(s["c"])(e.alarmTime),t.handlingAlarmImgUrl(e),t.fireWarningArray.push(e))})),this.fireTotalNum=this.fireWarningArray.length,n["a"].$emit("getFireAlarmInfos_Done",!0)},getTodayFireAlarmInfos:function(){var e=this;this.fireWarningArray=[],this.$axios.get(i["a"].getTodayFireAlarmInfos).then((function(t){t&&t.data&&0===t.data.code&&e.handlingFireWarningData(t.data.data)}))},getDurationFireAlarmInfos:function(e,t){var a=this;this.fireWarningArray=[];var n={timeBegin:e,timeEnd:t};this.$axios.get(i["a"].getDurationFireAlarmInfos,{params:n}).then((function(e){e&&e.data&&0===e.data.code&&a.handlingFireWarningData(e.data.data)}))},markFireWarnings:function(){void 0!==this.$refs.gduMap&&void 0!==this.$refs.gduMap.map2D&&(this.$refs.gduMap.map2D.devFireWarningLayerManager.clear(),this.$refs.gduMap.map2D.devFireWarningLayerManager.addFireWarnings(this.fireWarningArray))},addNewFireWarning:function(e){void 0!==this.$refs.gduMap&&void 0!==this.$refs.gduMap.map2D&&this.$refs.gduMap.map2D.devFireWarningLayerManager.addOrUpdateFireWarning(e)},selectFireWarningHandler:function(e,t){this.$refs.gduMap.showLayer("fire",!0),this.$refs.gduMap.map2D.devCameraLayerManager.resetSelectedFeature(),this.$refs.gduMap.map2D.devDroneLayerManager.resetSelectedFeature();var a=this.$refs.gduMap.map2D;a.devFireWarningLayerManager.selectFeatureByID(e),this.bAutoMove&&(a.setZoom(16),setTimeout((function(){a.zoomToCenter(e.alarmLongitude,e.alarmLatitude);var t=a._map.getView().getCenter(),i=a._map.getPixelFromCoordinate(t),n=i[0]-100,r=i[1]-120,s=a._map.getCoordinateFromPixel([n,r]);a.zoomToCenter(s[0],s[1])}),10))},copyCoordinateCB:function(e){var t=this;this.copyCoordinate=e.alarmLongitude+","+e.alarmLatitude,this.$nextTick((function(){t.$refs.copyText.click(),Object(r["Message"])({message:"坐标已复制!",type:"info",duration:3e3})}))},onCopyOK:function(e){console.log(e)},onCopyErr:function(e){console.log(e)},closeImgDialog:function(){this.imgDialogVisible=!1},delayShowFireDetailInfo:function(e){var t=this;setTimeout((function(){t.selectFireWarningHandler(e)}),500)},callbackLeftImg:function(e){this.imgSrc=e.alarmPicList[0].picPath,this.imgDialogVisible=!0,this.delayShowFireDetailInfo(e)},callbackMidImg:function(e){this.imgSrc=e.alarmPicList[0].picPath,this.imgDialogVisible=!0,this.delayShowFireDetailInfo(e)},callbackRightImg:function(e){this.imgSrc=e.alarmPicList[1].picPath,this.imgDialogVisible=!0,this.delayShowFireDetailInfo(e)},callbackMistaken:function(e){var t=this,a=i["a"].confirmFireAlarmInfo+"/"+e.id+"/"+e.alarmStatus;this.$axios.post(a).then((function(a){if(a&&a.data&&0===a.data.code){var i=t.fireWarningArray.find((function(t){return t.id===e.id}));if(void 0!==i){var n=t.fireWarningArray.indexOf(i);t.fireWarningArray.splice(n,1),t.fireTotalNum--}}}))},callbackConfirmed:function(e){var t=this,a=i["a"].confirmFireAlarmInfo+"/"+e.id+"/"+e.alarmStatus;this.$axios.post(a).then((function(a){if(a&&a.data&&0===a.data.code){var i=t.fireWarningArray.find((function(t){return t.id===e.id}));void 0!==i&&(i.bConfirmed=!0,i.alarmStatus=e.alarmStatus,t.fireConfirmedNum++)}}))}}};t["a"]=l},ae5c:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAARCAYAAAAyhueAAAABV0lEQVQ4T6WUsStFcRzFPwfJZGGVTCbKZpJJio2UnjxJykBMbO+9RVKSKCUWyWKwSfkDlDIZTCaLwcQojq5+V+9dz3Wfd9d7zud3v+f7O1ekPLangFtJ92m65Dv9JrY9CxwAfZLu6obaXgD2gAagt26o7RVgC4inqA9qew1YLwNGU5eAy5DtW5YYvjO1XQQKKaZX4AI4knSVBv+C2t4AVrN8RdDcAMuSrqt5ZHs7EtQAjKXvIaqCJJf7I+gisJPIsZYzToC8pI/YFI8/D+yHK1QLMNbuSlqqgIZc89ESgMb/UIEJSWeRt6JRtieBY6CpDDwNPAJtQGdUBmAA6Eoc/gR0S3r5UVPbY8Ap0BxMVS+/7R5gBpgDWoO2KKlUtfu2R4FolJa/amq7HdgMBzwDHWk/lCHgHOjP0n3bOeAQyP0KDcsbjPKU9JBlebaHgfFUaBZQUmN75BMmjnBGER7Z6AAAAABJRU5ErkJggg=="},b9ea:function(e,t,a){"use strict";var i=a("864b"),n=a.n(i);n.a},c466:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return s}));a("e18c"),a("1c2e");function i(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,i=e.getDate()<10?"0"+e.getDate():e.getDate(),n=e.getDay();switch(n){case 0:n="日";break;case 1:n="一";break;case 2:n="二";break;case 3:n="三";break;case 4:n="四";break;case 5:n="五";break;case 6:n="六";break}return{year:t,month:a,day:i,weekday:"星期"+n}}function n(e){var t=parseInt(e),a=0,i=0;t>=60&&(a=parseInt(t/60),t=parseInt(t%60),a>=60&&(i=parseInt(a/60),a=parseInt(a%60)));var n=r(i)+":"+r(a)+":"+r(t);return n}function r(e){return e<10?"0"+e.toString():e.toString()}function s(e){var t=function(e){return e<10?"0"+e:e},a=new Date(e),i=a.getFullYear(),n=a.getMonth()+1,r=a.getDate(),s=a.getHours(),o=a.getMinutes(),l=a.getSeconds();return i+"-"+t(n)+"-"+t(r)+" "+t(s)+":"+t(o)+":"+t(l)}},cce6:function(e,t,a){"use strict";var i=a("889e"),n=a.n(i);n.a}}]);