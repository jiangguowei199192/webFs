(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3b73e71a"],{"2f8e":function(e,i,t){"use strict";t.r(i);var a=function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",{staticClass:"videoContainer",attrs:{onload:"",onresize:""}},[t("VideoMain",{attrs:{showLeft:e.showLeft,showRight:e.showRight},on:{hideLeftNav:e.closeLeftNav,hideRightInfo:e.closeRightInfo}},[t("div",{attrs:{slot:"left"},slot:"left"},[t("div",{staticClass:"leftContainer"},[t("div",{staticClass:"tab"},[t("div",{class:{active:e.isOnline},on:{click:function(i){return i.stopPropagation(),e.changeOnlineOrAll(!0)}}},[e._v("在线")]),t("div",{class:{active:!e.isOnline},on:{click:function(i){return i.stopPropagation(),e.changeOnlineOrAll(!1)}}},[e._v("全部")])]),e.isOnline?[t("div",{staticClass:"onlineList webFsScroll"},e._l(e.onlineArray,(function(i,a){return t("div",{key:a,staticClass:"list",class:{selected:e.selectedIndex==a,unman:"WRJ"===i.deviceTypeCode}},[t("p",[t("span",{staticClass:"area"},[e._v(e._s(i.label))]),t("i",{directives:[{name:"show",rawName:"v-show",value:i.children&&i.children.some((function(e){return 1==e.isSelected})),expression:"item.children&&item.children.some(child=>{return child.isSelected==true})"}]})]),t("div",{staticClass:"btns"},e._l(i.children,(function(r,s){return t("el-button",{key:s,class:{visible:!r.isSelected,visibleSelected:r.isSelected},style:{backgroundColor:r.isSelected?"rgba(0,212,15,1)":"",color:r.isSelected?"#fff":"#1EB0FC"},attrs:{title:r.label},on:{click:function(t){return t.stopPropagation(),e.playDeviceVideo(i,r,a,s)}}},[e._v(e._s(r.label&&r.label.length>3?r.label.slice(0,3)+"..":r.label?r.label:"-"))])})),1)])})),0)]:[t("div",{staticClass:"search"},[t("el-input",{attrs:{type:"text",placeholder:"请输入设备名称","suffix-icon":"el-icon-search"},model:{value:e.filterDevice,callback:function(i){e.filterDevice="string"===typeof i?i.trim():i},expression:"filterDevice"}})],1),t("tree-data",{ref:"tree",attrs:{treeData:e.treeData},on:{videoChange:e.playOrClose}})],e.isOnline&&0===e.onlineArray.length||!e.isOnline&&0===e.treeData.length?t("div",{staticClass:"empty"},[e._v("暂无数据")]):e._e()],2)]),t("div",{attrs:{slot:"center"},slot:"center"},[t("div",{staticClass:"video"},[t("div",{staticClass:"box"},[t("div",{staticClass:"title"},[e._v("直播")]),t("div",{staticClass:"info"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.curSelectedVideo.labelTotal,expression:"curSelectedVideo.labelTotal"}],staticClass:"curSelected"},[e._v("当前选中:"+e._s(e.curSelectedVideo.labelTotal))]),t("div",{staticClass:"warning",on:{click:function(i){return i.stopPropagation(),e.$router.push({name:"fireAlarm"})}}},[t("img",{attrs:{src:e.firePic,alt:""}}),e._v(" 监控报警 "),t("b",[e._v(e._s(e.fireWarningArray.length))]),e._v("个 ")])])]),t("div",{ref:"videoList",staticClass:"videoList",class:{videolistFullscreen:e.dialogVisible}},e._l(e.curVideosArray,(function(i,a){return t("div",{key:a,style:e.machineStatusStyle1(e.showVideoPageSize)},[t("div",{ref:"video",refInFor:!0,class:{active:e.curVideoIndex===a},on:{click:function(t){return t.stopPropagation(),e.operateCurVideo(i,a)}}},[i.streamUrl?t("VideoWall",{key:a,ref:"videoCtrl",refInFor:!0,attrs:{videoInfo:i,playerWidth:e.playerWidth,playerHeight:e.playerHeight},on:{"update:videoInfo":function(e){i=e},"update:video-info":function(e){i=e},fullscreenvideo:e.fullscreenvideo}}):e._e()],1)])})),0),t("div",{staticClass:"tools"},[t("div",{staticClass:"leftTool"},[t("img",{attrs:{src:9==e.palace?e.nineSelectedPalace:e.ninePalace,title:"9宫格"},on:{click:function(i){return i.stopPropagation(),e.changeVideosType(9)}}}),t("img",{attrs:{src:4==e.palace?e.fourSelectedPalace:e.fourPalace,title:"4宫格"},on:{click:function(i){return i.stopPropagation(),e.changeVideosType(4)}}}),t("img",{attrs:{src:1==e.palace?e.oneSelectedPalace:e.onePalace,title:"1宫格"},on:{click:function(i){return i.stopPropagation(),e.changeVideosType(1)}}}),t("img",{attrs:{src:e.photoClicked?e.photoSelected:e.photo,title:"抓取"},on:{click:function(i){return i.stopPropagation(),e.showImg(i)}}}),t("img",{attrs:{src:e.mapClicked?e.mapSelected:e.map,title:"设备地图"},on:{click:function(i){i.stopPropagation(),e.mapClicked=!0,e.$router.push({name:"deviceMap"})}}}),t("img",{directives:[{name:"show",rawName:"v-show",value:e.showCutImg,expression:"showCutImg"}],attrs:{src:""+e.picUrl+e.cutImgUrl,alt:"",id:"pic"},on:{click:function(i){i.stopPropagation(),e.cutDialogVisible=!0}}})]),t("div",{staticClass:"rightTool"},[t("img",{attrs:{src:e.isPlayAll?e.closeAll:e.playAll,title:e.isPlayAll?"取消预览全部":"预览全部"},on:{click:function(i){return i.stopPropagation(),e.playAllVideos(i)}}}),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"page-size":e.showVideoPageSize,layout:"prev,next",total:e.totalVideosArray.length,"current-page":e.currentPage},on:{"update:currentPage":function(i){e.currentPage=i},"update:current-page":function(i){e.currentPage=i},"prev-click":e.pre,"next-click":e.next}})],1),t("img",{attrs:{src:e.dialogVisible?e.fullScreenSelected:e.fullScreen,title:e.dialogVisible?"取消全屏":"全屏"},on:{click:function(i){return i.stopPropagation(),e.openDialog()}}})])])])]),t("div",{attrs:{slot:"right"},slot:"right"},[t("div",{staticClass:"rightContent"},[t("div",{staticClass:"baseInfo"},[t("div",{staticClass:"info"},[e._v("基本信息")]),t("div",{staticClass:"detail"},[t("ul",{directives:[{name:"show",rawName:"v-show",value:Object.keys(e.curSelectedVideo).length>0,expression:"Object.keys(curSelectedVideo).length>0"}]},[t("li",[t("span",[e._v("设备名称：")]),t("span",[e._v(e._s(e.curSelectedVideo.parentLabel||"-"))])]),t("li",[t("span",[e._v("设备编号：")]),t("span",[e._v(e._s(e.curSelectedVideo.deviceCode||"-"))])]),t("li",[t("span",[e._v("设备品牌：")]),t("span",[e._v(e._s(e.curSelectedVideo.deviceBrand||"-"))])]),t("li",[t("span",[e._v("所在地点：")]),t("span",[e._v(e._s(e.curSelectedVideo.deviceAddress||"-"))])])])])]),t("div",{directives:[{name:"show",rawName:"v-show",value:"GDJK"===e.curSelectedVideo.deviceTypeCode,expression:"curSelectedVideo.deviceTypeCode==='GDJK'"}],staticClass:"deviceInfo"},[t("div",{staticClass:"info"},[e._v("云台")]),t("div",{staticClass:"operate"},[t("div",{staticClass:"icons"},e._l(9,(function(i,a){return t("div",{key:a,on:{mousedown:function(i){return e.startChange(a)},mouseup:function(i){return e.stopChange(a)}}})})),0),t("div",{staticClass:"btns"},[t("div",[t("span",{on:{mousedown:function(i){return e.startChange(1e3)},mouseup:function(i){return e.stopChange(1e3)}}},[e._v("+")]),t("b",[e._v("变倍")]),t("span",{on:{mousedown:function(i){return e.startChange(1001)},mouseup:function(i){return e.stopChange(1001)}}},[e._v("-")])]),t("div",[t("span",{on:{mousedown:function(i){return e.startChange(1002)},mouseup:function(i){return e.stopChange(1002)}}},[e._v("+")]),t("b",[e._v("变焦")]),t("span",{on:{mousedown:function(i){return e.startChange(1003)},mouseup:function(i){return e.stopChange(1003)}}},[e._v("-")])]),t("div",[t("span",{on:{mousedown:function(i){return e.startChange(1004)},mouseup:function(i){return e.stopChange(1004)}}},[e._v("+")]),t("b",[e._v("光圈")]),t("span",{on:{mousedown:function(i){return e.startChange(1005)},mouseup:function(i){return e.stopChange(1005)}}},[e._v("-")])])]),t("div",{staticClass:"slider"},[t("span",{staticClass:"demonstration"},[e._v("步速")]),t("el-slider",{staticStyle:{width:"98px","margin-left":"16px","margin-right":"16px"},attrs:{min:1,max:8},model:{value:e.step,callback:function(i){e.step=i},expression:"step"}}),t("span",[e._v(e._s(e.step))])],1),t("div",{staticClass:"sliderTip"},[e._v("步速值范围为1-8之间")])])]),t("div",{directives:[{name:"show",rawName:"v-show",value:"WRJ"===e.curSelectedVideo.deviceTypeCode,expression:"curSelectedVideo.deviceTypeCode==='WRJ'"}],staticClass:"deviceInfo"},[t("div",{staticClass:"info"},[e._v("位置")]),t("div",{staticClass:"mapBox"},[t("gMap",{ref:"gduMap",attrs:{handleType:"devMap",bShowSimpleSearchTools:!1,bShowBasic:!1,bShowMeasure:!1,bShowLonLat:!1,bAutoLocate:!1}})],1)])])])]),t("el-dialog",{staticClass:"cutDialog",attrs:{visible:e.cutDialogVisible,"close-on-click-modal":!1,"show-close":!1,"before-close":e.clearRemark},on:{"update:visible":function(i){e.cutDialogVisible=i}}},[t("img",{attrs:{src:""+e.picUrl+e.cutImgUrl,width:"743px",height:"428px",alt:""}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("div",{staticClass:"remark"},[t("div",{staticClass:"replain"},[t("span",[e._v("说明：")]),t("el-input",{attrs:{placeholder:"请输入",maxlength:27},model:{value:e.remark,callback:function(i){e.remark="string"===typeof i?i.trim():i},expression:"remark"}})],1),t("div",[t("el-button",{staticStyle:{width:"87px"},on:{click:function(i){e.cutDialogVisible=!1,e.remark=""}}},[e._v("取 消")]),t("el-button",{staticStyle:{width:"87px"},attrs:{type:"primary"},on:{click:function(i){return i.stopPropagation(),e.confirm(i)}}},[e._v("确 定")])],1)])])])],1)},r=[],s=(t("b4fb"),t("dbb3"),t("fe59"),t("ecb4"),t("77ad"),t("ea69"),t("513c"),t("fe8a"),t("08ba"),t("4e09")),o=t("04e6"),n=t("e27c"),c=t("9a0d"),l=t("0eca"),d=t("6501"),h=t("4c82"),u=t("0a1b"),p=t("c9b7"),f=t("986e"),g=t("4ae9"),m={name:"videoContainer",components:{VideoMain:s["a"],TreeData:o["a"],VideoWall:d["a"]},data:function(){return{playerWidth:"",playerHeight:"",picUrl:u["a"].baseUrl+"/video-service2",curScreenInfo:{},firePic:t("4c0f"),palace:9,zoomSpeed:0,focusSpeed:0,lrisSpeed:0,mapClicked:!1,photoClicked:!1,showCutImg:!1,cutImgUrl:"",dialogVisible:!1,cutDialogVisible:!1,remark:"",currentPage:1,totalVideosArray:[],curVideosArray:[],showVideoPageSize:9,curVideoIndex:1e3,step:4,recordNums:{leftUp:0,up:0,rightUp:0,left:0,right:0,leftDown:0,down:0,rightDown:0,zoomAdd:0,zoomMinus:0,focusAdd:0,focusMinus:0,lrisAdd:0,lrisMinus:0},isPlayAll:!1,curSelectedVideo:{},imgId:"",bHasFullVideo:!1}},mixins:[n["a"],c["a"],l["a"]],methods:{changeOnlineOrAll:function(e){if(Number(this.isOnline)!==Number(e)){if(this.isOnline=e,this.isOnline)for(var i=document.querySelectorAll(".el-tree-node"),t=0;t<i.length;t++)i[t].classList.remove("is-current");else this.selectedIndex=200,this.onlineArray.forEach((function(e){e.children.forEach((function(e){e.isSelected=!1}))}));this.currentPage=1,this.showVideoPageSize=9,this.palace=9,this.zoomSpeed=0,this.focusSpeed=0,this.lrisSpeed=0,this.recordNums={leftUp:0,up:0,rightUp:0,left:0,right:0,leftDowm:0,dowm:0,rightDown:0,zoomAdd:0,zoomMinus:0,focusAdd:0,focusMinus:0,lrisAdd:0,lrisMinus:0},this.step=4,this.mapClicked=!1,this.photoClicked=!1,this.isPlayAll=!1,this.curVideoIndex=1e3,this.curSelectedVideo={},this.init()}},playDeviceVideo:function(e,i,t,a){var r=Object.assign({},i,{isShowOperate:!1,deviceCode:e.id,deviceAddress:e.deviceAddress,deviceBrand:e.deviceBrand,parentLabel:e.label,labelTotal:e.label+"-"+i.label});console.log(r),this.onlineArray[t].children[a].isSelected?(this.$set(this.onlineArray[t].children[a],"isSelected",!1),this.selectedIndex=200,this.playOrClose(2,r)):(this.selectedIndex=t,this.$set(this.onlineArray[t].children[a],"isSelected",!0),this.playOrClose(1,r))},clearRecord:function(e){for(var i in this.recordNums)i!==e&&(this.recordNums[i]=0)},startChange:Object(p["a"])((function(e){var i={device_id:this.curSelectedVideo.deviceCode,channel_id:this.curSelectedVideo.streamType};switch(e){case 0:i.cmd_type=32,i.step=this.step,i.stop=0,console.dir(i),this.changeViewVideo(i);break;case 1:i.cmd_type=0,i.step=this.step,i.stop=0,console.dir(i),this.changeViewVideo(i);break;case 2:i.cmd_type=33,i.step=this.step,i.stop=0,console.dir(i),this.changeViewVideo(i);break;case 3:i.cmd_type=2,i.step=this.step,i.stop=0,console.dir(i),this.changeViewVideo(i);break;case 4:break;case 5:i.cmd_type=3,i.step=this.step,i.stop=0,console.dir(i),this.changeViewVideo(i);break;case 6:i.cmd_type=34,i.step=this.step,i.stop=0,console.dir(i),this.changeViewVideo(i);break;case 7:i.cmd_type=1,i.step=this.step,i.stop=0,console.dir(i),this.changeViewVideo(i);break;case 8:i.cmd_type=35,i.step=this.step,i.stop=0,console.dir(i),this.changeViewVideo(i);break;case 1e3:i.cmd_type=4,i.step=this.step,i.stop=0,console.dir(i),this.changeViewVideo(i);break;case 1001:i.cmd_type=5,i.step=this.step,i.stop=0,console.dir(i),this.changeViewVideo(i);break;case 1002:i.cmd_type=6,i.step=this.step,i.stop=0,console.dir(i),this.changeViewVideo(i);break;case 1003:i.cmd_type=7,i.step=this.step,i.stop=0,console.dir(i),this.changeViewVideo(i);break;case 1004:i.cmd_type=8,i.step=this.step,i.stop=0,console.dir(i),this.changeViewVideo(i);break;case 1005:i.cmd_type=9,i.step=this.step,i.stop=0,console.dir(i),this.changeViewVideo(i);break;default:break}}),500),stopChange:Object(p["a"])((function(e){if(4!==e){var i={device_id:this.curSelectedVideo.deviceCode,channel_id:this.curSelectedVideo.streamType,stop:1,step:0,cmd_type:""};switch(e){case 0:i.cmd_type=32;break;case 1:i.cmd_type=0;break;case 2:i.cmd_type=33;break;case 3:i.cmd_type=2;break;case 4:break;case 5:i.cmd_type=3;break;case 6:i.cmd_type=34;break;case 7:i.cmd_type=1;break;case 8:i.cmd_type=35;break;case 1e3:i.cmd_type=4;break;case 1001:i.cmd_type=5;break;case 1002:i.cmd_type=6;break;case 1003:i.cmd_type=7;break;case 1004:i.cmd_type=8;break;case 1005:i.cmd_type=9;break}console.log(i),this.changeViewVideo(i)}}),500),changeViewVideo:function(e){this.$axios.post("/video-service2/index/api/ptzConrol",e).then((function(e){e&&e.data&&0===e.data.code&&console.log("操作成功了！")}))},refreshMap:function(e){if(void 0!==e&&null!==e&&"WRJ"===e.deviceTypeCode){this.setDroneDevCode(e.deviceCode);var i=this.$refs.gduMap.map2D;setTimeout((function(){i._map.updateSize()}),1)}},playOrClose:function(e,i){var t=this;if(1===e)if(i.deviceTypeCode,this.curSelectedVideo=JSON.parse(JSON.stringify(i)),console.log("当前选中",this.curSelectedVideo),this.refreshMap(i),1e3===this.curVideoIndex){var a=this.totalVideosArray.indexOf("");if(-1!==a){this.totalVideosArray.splice(a,1,i);var r=Math.floor(a/this.showVideoPageSize);this.curVideosArray=this.totalVideosArray.slice(r*this.showVideoPageSize,(r+1)*this.showVideoPageSize),this.currentPage=r+1}else this.totalVideosArray.push(i),this.currentPage=Math.ceil(this.totalVideosArray.length/this.showVideoPageSize),this.next(this.currentPage)}else{this.curVideosArray[this.curVideoIndex]&&(this.isOnline?this.onlineArray.forEach((function(e,i){e.children.forEach((function(e,a){e.id===t.curVideosArray[t.curVideoIndex].id&&t.$set(t.onlineArray[i].children[a],"isSelected",!1)}))})):(document.querySelector("#liveVideo"+this.curVideosArray[this.curVideoIndex].id).parentElement.setAttribute("class",""),document.querySelector("#liveVideo"+this.curVideosArray[this.curVideoIndex].id).parentElement.parentElement.parentElement.parentElement.classList.remove("is-current")));var s=this.curVideoIndex+this.showVideoPageSize*(this.currentPage-1);this.totalVideosArray.splice(s,1,i),this.curVideoIndex=1e3,this.curVideosArray=this.totalVideosArray.slice((this.currentPage-1)*this.showVideoPageSize,this.currentPage*this.showVideoPageSize)}else{"GDJK"===i.deviceTypeCode&&((new g["a"]).client.send("video/stop/algorithm",JSON.stringify({deviceCode:i.deviceCode,channelId:i.streamType,streamUrl:i.streamUrl,isOpen:0})),(new g["a"]).client.send(" video/stop/arAlgorithm",JSON.stringify({deviceCode:i.deviceCode,channelId:i.streamType,streamUrl:i.streamUrl,isOpen:0}))),this.curSelectedVideo={},this.curVideoIndex=1e3,this.totalVideosArray.forEach((function(e,a){e.id===i.id&&t.totalVideosArray.splice(a,1,"")})),this.curVideosArray=this.totalVideosArray.slice((this.currentPage-1)*this.showVideoPageSize,this.currentPage*this.showVideoPageSize);var o=0;this.curVideosArray.forEach((function(e){e&&(o=1)})),0===o&&(this.isPlayAll=!1)}},operateCurVideo:function(e,i){var t=this;if(this.curVideoIndex=i,"WRJ"===e.deviceTypeCode){this.setDroneDevCode(e.deviceCode);var a=this.$refs.gduMap.map2D;setTimeout((function(){a._map.updateSize()}),1)}if(this.curVideosArray[this.curVideoIndex])if(this.curSelectedVideo=e,this.isOnline)this.onlineArray.forEach((function(i,a){i.children&&i.children.length>0&&i.children.forEach((function(i){i.id===e.id&&(t.selectedIndex=a,i.isSelected=!0)}))}));else{for(var r=document.querySelectorAll(".el-tree-node"),s=0;s<r.length;s++)r[s].classList.remove("is-current");document.querySelector("#liveVideo"+this.curVideosArray[this.curVideoIndex].id).parentElement.parentElement.parentElement.parentElement.classList.add("is-current")}},playAllVideos:Object(p["a"])((function(){var e=this,i=document.querySelectorAll(".el-tree-node__content span.is-leaf +span.custom-tree-node>span >b");if(console.log(i),this.currentPage=1,this.totalVideosArray=[],this.curVideoIndex=1e3,this.curSelectedVideo={},this.isOnline){var t=document.querySelectorAll(".leftContainer > div.list");if(this.isPlayAll){for(var a=0;a<t.length;a++)t[a].classList.remove("selected");this.onlineArray.forEach((function(e){e.children&&e.children.length>0&&e.children.forEach((function(e){e.isSelected=!1}))}))}else{for(var r=0;r<t.length;r++)t[r].classList.remove("selected");this.onlineArray.forEach((function(i){i.children&&i.children.length>0&&i.children.forEach((function(t){if("online"===t.onlineStatus){t.isSelected=!0;var a=Object.assign({},t,{deviceCode:i.id,deviceAddress:i.deviceAddress,deviceBrand:i.deviceBrand,parentLabel:i.label,labelTotal:i.label+"-"+t.label});e.totalVideosArray.push(a)}}))}))}}else for(var s=0;s<i.length;s++)if(!JSON.parse(i[s].getAttribute("obj")).children&&"online"===JSON.parse(i[s].getAttribute("obj")).onlineStatus)if(this.isPlayAll){for(var o=document.querySelectorAll(".el-tree-node"),n=0;n<o.length;n++)o[n].classList.remove("is-current");i[s].parentElement.setAttribute("class","")}else i[s].parentElement.setAttribute("class","liveIcon"),this.totalVideosArray.push(JSON.parse(i[s].getAttribute("obj")));if(this.showVideoPageSize>this.totalVideosArray.length)for(var c=this.totalVideosArray.length,l=0;l<this.showVideoPageSize-c;l++)this.totalVideosArray.push("");for(var d=function(i){setTimeout((function(){e.curVideosArray.splice(i,1,e.totalVideosArray[i])}),300)},h=0;h<this.showVideoPageSize;h++)d(h);this.isPlayAll=!this.isPlayAll}),500),changeVideosType:function(e){this.palace=e,this.currentPage=1,this.curVideoIndex=1e3,this.showVideoPageSize=e;var i=[];this.totalVideosArray.forEach((function(e){e&&i.push(e)}));for(var t=0;t<this.totalVideosArray.length-i.length;t++)i.push("");this.totalVideosArray=i;var a=this.totalVideosArray.filter((function(e){return""!==e}));if(a.length<=e)if(this.totalVideosArray.length>=e)this.curVideosArray=this.totalVideosArray.slice(0,e),this.totalVideosArray=this.totalVideosArray.slice(0,e);else{for(var r=this.totalVideosArray.length,s=0;s<e-r;s++)this.totalVideosArray.push("");this.curVideosArray=this.totalVideosArray.slice(0,e)}else this.totalVideosArray=this.totalVideosArray.filter((function(e){return""!==e})),this.curVideosArray=this.totalVideosArray.slice(0,e),console.log(this.curVideosArray);this.curVideosArray[0]?this.activeFirstTree():this.curSelectedVideo={}},activeFirstTree:function(){var e=this;if(this.isOnline)console.log(this.curVideosArray),this.onlineArray.forEach((function(i,t){i.children&&i.children.length>0&&i.children.forEach((function(i){i.id===e.curVideosArray[0].id&&(e.selectedIndex=t,i.isSelected=!0)}))}));else{for(var i=document.querySelectorAll(".el-tree-node"),t=0;t<i.length;t++)i[t].classList.remove("is-current");document.querySelector("#liveVideo"+this.curVideosArray[0].id).parentElement.parentElement.parentElement.parentElement.classList.add("is-current")}this.curVideosArray[0]?this.curSelectedVideo=this.curVideosArray[0]:this.selectedIndex=200},pre:function(e){this.curVideoIndex=1e3,console.log("总共",this.totalVideosArray),this.curVideosArray=this.totalVideosArray.slice((e-1)*this.showVideoPageSize,e*this.showVideoPageSize),console.log("当前",this.curVideosArray),this.curVideosArray[0]?this.activeFirstTree():this.curSelectedVideo={}},next:function(e){if(this.curVideoIndex=1e3,e*this.showVideoPageSize>this.totalVideosArray.length)for(var i=this.totalVideosArray.length,t=0;t<e*this.showVideoPageSize-i;t++)this.totalVideosArray.push("");console.log(this.totalVideosArray.length),this.curVideosArray=this.totalVideosArray.slice((e-1)*this.showVideoPageSize,e*this.showVideoPageSize),this.activeFirstTree()},machineStatusStyle1:function(e){return 9===e?{width:"33.33%",height:"33.33%"}:4===e?{width:"50%",height:"50%"}:1===e?{width:"100%",height:"100%"}:void 0},checkFull:function(){var e=window.fullScreen||document.webkitIsFullScreen||document.msFullscreenEnabled;return void 0===e&&(e=!1),e},fullscreenvideo:function(e){var i=this;this.curScreenInfo=e.info,!0===e.bfull?(this.totalVideosArray.forEach((function(t,a){t.id===e.info.id&&i.$set(i.totalVideosArray[a],"isShowOperate",!0)})),this.curVideosArray.forEach((function(t,a){t.id===e.info.id&&i.$set(i.curVideosArray[a],"isShowOperate",!0)}))):(this.totalVideosArray.forEach((function(t,a){t.id===e.info.id&&i.$set(i.totalVideosArray[a],"isShowOperate",!1)})),this.curVideosArray.forEach((function(t,a){t.id===e.info.id&&i.$set(i.curVideosArray[a],"isShowOperate",!1)}))),this.bHasFullVideo=e.bfull},init:function(){this.totalVideosArray=[];for(var e=0;e<9;e++)this.totalVideosArray.push("");this.curVideosArray=this.totalVideosArray.slice(0,this.showVideoPageSize)},deviceOffline:function(e){var i=this;e.id===this.curSelectedVideo.deviceCode&&(this.isOnline&&(this.selectedIndex=200),this.curSelectedVideo={}),this.totalVideosArray.forEach((function(t,a){t.deviceCode===e.id&&i.totalVideosArray.splice(a,1,"")})),this.curVideosArray=this.totalVideosArray.slice((this.currentPage-1)*this.showVideoPageSize,this.currentPage*this.showVideoPageSize)},showImg:Object(p["b"])((function(){var e=this;if(0!==Object.keys(this.curSelectedVideo).length){var i={deviceCode:this.curSelectedVideo.deviceCode,channleId:this.curSelectedVideo.streamType};this.$axios.post(h["a"].deviceSnap,i).then((function(i){i&&i.data&&0===i.data.code&&(e.showCutImg=!0,e.imgId=i.data.data.id,e.cutImgUrl=i.data.data.filePath,e.$notify.success({title:"成功",message:"抓取成功！",duration:800}),setTimeout((function(){e.showCutImg=!1}),4e3))}))}else this.$notify.warning({title:"警告",message:"请先选择设备！"})}),5e3),confirm:function(){var e=this;0===Object.keys(this.curSelectedVideo).length&&this.$notify.warning({title:"警告",message:"请先选择设备！"});var i={id:this.imgId,deviceCode:this.curSelectedVideo.deviceCode,filePath:this.cutImgUrl,channelId:this.curSelectedVideo.streamType,remark:this.remark};this.$axios.post(h["a"].deviceUpdate,i).then((function(i){i&&i.data&&0===i.data.code&&(e.$notify.success({title:"成功",message:"添加说明成功！"}),e.cutDialogVisible=!1,e.clearRemark())}))},clearRemark:function(){this.remark=""},moveElement:function(e,i,t){console.log(i,t);var a=setInterval((function(){var r=document.getElementById(e),s=parseInt(r.offsetLeft),o=parseInt(r.offsetTop);console.log(s,o),s===i&&o===t&&clearInterval(a),s<i&&s++,s>i&&s--,o<t&&o++,o>t&&o--,r.style.left=s+"px",r.style.top=o+"px"}),1)},openDialog:function(){var e=this;this.dialogVisible=!0,setTimeout((function(){e.$notify({dangerouslyUseHTMLString:!0,title:"提示",message:"按esc键可退出全屏",type:"info",duration:3e3})}),500)},addTitle:function(){var e=this;this.$nextTick((function(){var i=document.querySelector(".el-pagination > .btn-prev"),t=document.querySelector(".el-pagination > .btn-next");i.getAttribute("disabled")?i.removeAttribute("title"):i.title="当前页".concat(e.currentPage," / ").concat(Math.ceil(e.totalVideosArray.length/e.showVideoPageSize)),t.getAttribute("disabled")?t.removeAttribute("title"):t.title="当前页".concat(e.currentPage," / ").concat(Math.ceil(e.totalVideosArray.length/e.showVideoPageSize))}))},getPlayerStyle:function(){var e=this;this.$nextTick((function(){e.playerWidth=e.$refs.video[0].clientWidth,e.playerHeight=e.$refs.video[0].clientHeight}))}},created:function(){this.init();var e=this;document.addEventListener("keyup",(function(i){27===i.keyCode&&!e.bHasFullVideo&&e.dialogVisible&&(e.dialogVisible=!1)}))},mounted:function(){var e=this;this.getPlayerStyle(),f["a"].$on("peopleRealChange",(function(i){e.totalVideosArray.forEach((function(t,a){t.deviceCode===i.deviceCode&&t.streamType===i.channelId&&e.$set(e.totalVideosArray[a],"positionList",i.positionList)})),e.curVideosArray.forEach((function(t,a){t.deviceCode===i.deviceCode&&t.streamType===i.channelId&&e.$set(e.curVideosArray[a],"positionList",i.positionList)}))})),f["a"].$on("getArChange",(function(i){console.log(i),e.totalVideosArray.forEach((function(t,a){t.deviceCode===i.deviceCode&&t.streamType===i.channelId&&e.$set(e.totalVideosArray[a],"arPositionList",i.arPositionList)})),e.curVideosArray.forEach((function(t,a){t.deviceCode===i.deviceCode&&t.streamType===i.channelId&&e.$set(e.curVideosArray[a],"arPositionList",i.arPositionList)}))})),this.bSaveMultiDroneInfos=!0}},v=m,y=(t("41c9"),t("9ca4")),V=Object(y["a"])(v,a,r,!1,null,"53af16c2",null);i["default"]=V.exports},"3a1b":function(e,i,t){"use strict";t.d(i,"a",(function(){return a}));var a={getTodayFireAlarmInfos:"/cloud-video/deviceAlarm",getDurationFireAlarmInfos:"/cloud-video/deviceAlarm/list",confirmFireAlarmInfo:"/cloud-video/deviceAlarm/status"}},"41c9":function(e,i,t){"use strict";var a=t("6dde"),r=t.n(a);r.a},"4c0f":function(e,i){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAbCAYAAAB4Kn/lAAACoUlEQVRIS6XVW6hVVRTG8d/E1EKzLFMpUbKXUCIiFRUkFAsf9FXxghEFiYhIPVlhilA+iOCT4KW80IkEQVQElShIQkIEy0BBMm8vKhiFpkdxydhrnuPe273OEh0vm73GN/9rrm+OMWbyiFEwDF/ibGJj3bJUJ4h8wQx8j+H4PPFV3bpacMF72IeBGbY6seaJwAUv4w+80ARam1j1pOBv8EEbZGNixWODC17CJQxog3QlFraDC4bg2cTlyFV6XPAhtnbY2bHElObnBcuxFmsSG+rA2/F+B/D/eC5xJ1dMAL/Iug2JT+vAv2FihZczEz8WTMKxpi//OTG9BVwwFhMSu/NOwt9XKsC7E/MKdmFRk6YbIxPXGx5n6K9RWol387PreL4CfE/pc2xiTJtmaWJTKsoDDOhkhH/DEjcL/sPgPsrqbP6iZ9o0pxJvBHg29jclFya6Cv6N8qmr14r89AB3YX6T4LjyUK7ixccEbwvweYxu9ynX5QNwtEuYc+uRXvVXgO+iX5s8ajS8f6r3+Up8rDTuVC38XoBvd2jb1pUj8iiKXV/A6/mYq/l3Axyn+1qlpj+O4J0mRTR7jKfquBjgHzC3UvMdFrRlN2NJ2QAVcSDAi7GjoyCmbqeRvhcHlafzbceVywI8CH9HY7RIxuNkh2MN0Z5oXIzLv9HID+JGdGNPS8dEWt+Sjn+NOdUhruTbL1Jv40SLZl1iZQ84yuqX3NalalP2sc8zwpv4vVd0Jl6VuNE76PP9dhSvNmQfYUsNNZo+Wii85hqmJU7Hn5YbpGBUvpHfajgfhRheVsXX+KyRPIc5iT97pA9dTQVPZ/knphrkUMWM+wmz3NFtm9LTf5rf39edFx+5yASzrDbJNEMNlpx322EnLHdQt52p7MWH4j5ww53XmhjwTQAAAABJRU5ErkJggg=="},"6dde":function(e,i,t){},"9a0d":function(e,i,t){"use strict";t("4194"),t("fe59"),t("ecb4"),t("ea69"),t("08ba");var a=t("3a1b"),r=t("986e"),s=t("b705"),o=t("c466"),n=t("0a1b"),c={data:function(){return{fireWarningArray:[],fireConfirmedNum:0,fireTotalNum:0,bAutoMove:!0,copyCoordinate:"",imgDialogVisible:!1,imgSrc:""}},created:function(){var e=this;this.bShowMarkersInMap&&r["a"].$on("getFireAlarmInfos_Done",(function(i){e.markFireWarnings()})),r["a"].$on("getFireAlarm",(function(i){"mistaken"!==i.alarmStatus&&(i.bConfirmed=!1,i.alarmTime=Object(o["c"])(i.alarmTime),e.handlingAlarmImgUrl(i),e.fireWarningArray.push(i),e.fireTotalNum=e.fireWarningArray.length,e.bShowMarkersInMap&&e.addNewFireWarning(i))})),this.getTodayFireAlarmInfos()},beforeDestroy:function(){this.bShowMarkersInMap&&r["a"].$off("getFireAlarmInfos_Done"),this.bRealTimeFireWarning&&r["a"].$off("getFireAlarm")},mounted:function(){this.bShowMarkersInMap&&(this.$refs.gduMap.map2D.devFireWarningLayerManager.popupCopyBtnClickEvent.addEventListener(this.copyCoordinateCB),this.$refs.gduMap.map2D.devFireWarningLayerManager.popupLeftImgClickEvent.addEventListener(this.callbackLeftImg),this.$refs.gduMap.map2D.devFireWarningLayerManager.popupOneImgClickEvent.addEventListener(this.callbackMidImg),this.$refs.gduMap.map2D.devFireWarningLayerManager.popupRightImgClickEvent.addEventListener(this.callbackRightImg),this.$refs.gduMap.map2D.devFireWarningLayerManager.popupMisreportBtnClickEvent.addEventListener(this.callbackMistaken),this.$refs.gduMap.map2D.devFireWarningLayerManager.popupConfirmBtnClickEvent.addEventListener(this.callbackConfirmed))},methods:{handlingAlarmImgUrl:function(e){e.alarmPicList&&e.alarmPicList.length>0&&e.alarmPicList.forEach((function(e){e.picPath=n["a"].baseUrl+"/video-service2"+e.picPath}))},handlingFireWarningData:function(e){var i=this;e.forEach((function(e){"mistaken"!==e.alarmStatus&&(e.bConfirmed=!1,"confirmed"===e.alarmStatus&&(e.bConfirmed=!0,i.fireConfirmedNum++),e.alarmTime=Object(o["c"])(e.alarmTime),i.handlingAlarmImgUrl(e),i.fireWarningArray.push(e))})),this.fireTotalNum=this.fireWarningArray.length,r["a"].$emit("getFireAlarmInfos_Done",!0)},getTodayFireAlarmInfos:function(){var e=this;this.fireWarningArray=[],this.$axios.get(a["a"].getTodayFireAlarmInfos).then((function(i){i&&i.data&&0===i.data.code&&e.handlingFireWarningData(i.data.data)}))},getDurationFireAlarmInfos:function(e,i){var t=this;this.fireWarningArray=[];var r={timeBegin:e,timeEnd:i};this.$axios.get(a["a"].getDurationFireAlarmInfos,{params:r}).then((function(e){e&&e.data&&0===e.data.code&&t.handlingFireWarningData(e.data.data)}))},markFireWarnings:function(){void 0!==this.$refs.gduMap&&void 0!==this.$refs.gduMap.map2D&&(this.$refs.gduMap.map2D.devFireWarningLayerManager.clear(),this.$refs.gduMap.map2D.devFireWarningLayerManager.addFireWarnings(this.fireWarningArray))},addNewFireWarning:function(e){void 0!==this.$refs.gduMap&&void 0!==this.$refs.gduMap.map2D&&this.$refs.gduMap.map2D.devFireWarningLayerManager.addOrUpdateFireWarning(e)},selectFireWarningHandler:function(e,i){this.$refs.gduMap.showLayer("fire",!0),this.$refs.gduMap.map2D.devCameraLayerManager.resetSelectedFeature(),this.$refs.gduMap.map2D.devDroneLayerManager.resetSelectedFeature();var t=this.$refs.gduMap.map2D;t.devFireWarningLayerManager.selectFeatureByID(e),this.bAutoMove&&(t.setZoom(16),setTimeout((function(){t.zoomToCenter(e.alarmLongitude,e.alarmLatitude);var i=t._map.getView().getCenter(),a=t._map.getPixelFromCoordinate(i),r=a[0]-100,s=a[1]-120,o=t._map.getCoordinateFromPixel([r,s]);t.zoomToCenter(o[0],o[1])}),10))},copyCoordinateCB:function(e){var i=this;this.copyCoordinate=e.alarmLongitude+","+e.alarmLatitude,this.$nextTick((function(){i.$refs.copyText.click(),Object(s["Message"])({message:"坐标已复制!",type:"info",duration:3e3})}))},onCopyOK:function(e){console.log(e)},onCopyErr:function(e){console.log(e)},closeImgDialog:function(){this.imgDialogVisible=!1},delayShowFireDetailInfo:function(e){var i=this;setTimeout((function(){i.selectFireWarningHandler(e)}),500)},callbackLeftImg:function(e){this.imgSrc=e.alarmPicList[0].picPath,this.imgDialogVisible=!0,this.delayShowFireDetailInfo(e)},callbackMidImg:function(e){this.imgSrc=e.alarmPicList[0].picPath,this.imgDialogVisible=!0,this.delayShowFireDetailInfo(e)},callbackRightImg:function(e){this.imgSrc=e.alarmPicList[1].picPath,this.imgDialogVisible=!0,this.delayShowFireDetailInfo(e)},callbackMistaken:function(e){var i=this,t=a["a"].confirmFireAlarmInfo+"/"+e.id+"/"+e.alarmStatus;this.$axios.post(t).then((function(t){if(t&&t.data&&0===t.data.code){var a=i.fireWarningArray.find((function(i){return i.id===e.id}));if(void 0!==a){var r=i.fireWarningArray.indexOf(a);i.fireWarningArray.splice(r,1),i.fireTotalNum--}}}))},callbackConfirmed:function(e){var i=this,t=a["a"].confirmFireAlarmInfo+"/"+e.id+"/"+e.alarmStatus;this.$axios.post(t).then((function(t){if(t&&t.data&&0===t.data.code){var a=i.fireWarningArray.find((function(i){return i.id===e.id}));void 0!==a&&(a.bConfirmed=!0,a.alarmStatus=e.alarmStatus,i.fireConfirmedNum++)}}))}}};i["a"]=c},b4fb:function(e,i,t){"use strict";var a=t("1c8b"),r=t("efe2"),s=t("74e7"),o=t("a719"),n=t("3553"),c=t("d88d"),l=t("1bbd"),d=t("1ca1"),h=t("1ea7"),u=t("90fb"),p=t("f594"),f=u("isConcatSpreadable"),g=9007199254740991,m="Maximum allowed index exceeded",v=p>=51||!r((function(){var e=[];return e[f]=!1,e.concat()[0]!==e})),y=h("concat"),V=function(e){if(!o(e))return!1;var i=e[f];return void 0!==i?!!i:s(e)},A=!v||!y;a({target:"Array",proto:!0,forced:A},{concat:function(e){var i,t,a,r,s,o=n(this),h=d(o,0),u=0;for(i=-1,a=arguments.length;i<a;i++)if(s=-1===i?o:arguments[i],V(s)){if(r=c(s.length),u+r>g)throw TypeError(m);for(t=0;t<r;t++,u++)t in s&&l(h,u,s[t])}else{if(u>=g)throw TypeError(m);l(h,u++,s)}return h.length=u,h}})}}]);